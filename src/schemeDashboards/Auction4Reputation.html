<template>
  <instructions>Bid the current account in the current auction. If all auctions are over, them redeem for a
    given account.</instructions>
  <div class="arc-scheme-dashboard">
    <spinbutton onclick.call="refresh()" as-button="true" text="Refresh" spin.to-view="refreshing" title="Refresh"></spinbutton>
    <form class="form">
      <div class="card" if.to-view="!auctionIsOver" style="margin-bottom: 2rem">
        <div class="card-body">
          <div class="card-title">Bid</div>
          <div class="form-group bmd-form-group" style="width: 10rem;">
            <label for="bidAmount">Bid amount</label>
            <input id="bidAmount" class="form-control" type="number" value.bind="bidAmount | ethwei & updateTrigger:'blur'" />
            <span class="bmd-help">Number of tokens to bid</span>
          </div>
          <div class="form-group bmd-form-group">
            <button class=" btn-submit-proposal" click.delegate="bid(bidAmount)">Bid...</button>
          </div>
        </div>
      </div>

      <div class="card" if.to-view="auctionIsOver">
        <div class="card-body">
          <div class="card-title" style="margin-bottom: 1.5rem">Redeem</div>
          <div class="dropdown mb-3">
            <a class="dropdown-toggle" id="auctionIds" href="#" data-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">${(auctionId
              === -1) ? "Select an Auction" : "Auction " +
              auctionId}</a>

            <ul class="dropdown-menu" aria-labelledby="auctionIds">
              <li class="dropdown-item" click.delegate="setAuctionId(auctionId)" repeat.for="auctionId of numberOfAuctions">Auction
                ${auctionId}</li>
            </ul>
          </div>

          <div if.to-view="(auctionId >= 0) && !userHasBid">You have not bid in this auction, so there is nothing to
            redeem</div>
          <div if.to-view="(auctionId >= 0) && userHasBid">
            <div class="form-group bmd-form-group">
              <label for="beneficiaryAddress" class="input-group-text">Beneficiary Address</label>
              <input id="beneficiaryAddress" class="form-control" value.bind="beneficiary & updateTrigger:'blur'" />
              <span class="bmd-help">The beneficiary to receive redeemed reputation</span>
            </div>
            <button if.to-view="auctionId !== -1" class="btn-submit-proposal" click.delegate="redeem(auctionId, beneficiary)">Redeem...</button>
          </div>
        </div>
      </div>
    </form>
  </div>
</template>
