<template>
  <div if.bind="!dataLoaded">
    <pageloading></pageloading>
  </div>
  <div else>
    <div if.bind="!org" class="container admin-page">
      <h3>Please ensure you are connected to the right blockchain network.</h3>
    </div>
    <div else ref="dashboardElement">

      <div class="dashboard-header">
        <a href="#" class="hover-icon logo" id="avatarHoverIcon"><img src="../../static/dutchx-blue.svg" /></a>
        <h4>Welcome to the DutchX DAO</h2>
      </div>

      <div if.bind="!schemesLoaded">
        <pageloading></pageloading>
      </div>
      <div else>
        <div class="dashboard-schemes-container row" id="accordion_arc_schemes" role="tablist" show.bind="registeredArcSchemes.length">
          <div class="col-8 offset-2">
            <hr style="margin-bottom: 1.5rem" />
            <h5>How would you like to claim your reputation?</h5>
            <ul class="list-group clean dashboard-schemes">
              <li class="list-group-item" repeat.for="scheme of registeredArcSchemes">
                <div class="row scheme-use-button" data-toggle="collapse" data-target="#${scheme.name}" aria-expanded="false"
                  aria-controls="#${scheme.name}">
                  <div class="col-11">
                    <div class="scheme-icon">
                      <img if.one-time="dutchXSchemes.get(scheme.name).icon" src.one-time="dutchXSchemes.get(scheme.name).icon" />
                    </div>
                    <div class="scheme-name">
                      ${scheme.friendlyName}
                    </div>
                  </div>
                  <div class="scheme-arrow-down col-1"><span class="material-icons">keyboard_arrow_down</span></div>
                  <div class="scheme-arrow-up col-1"><span class="material-icons">keyboard_arrow_up</span></div>
                </div>
                <div id.bind="scheme.name" class="scheme-dashboard collapse" data-parent="#accordion_arc_schemes">
                  <div class="card">
                    <div class="card-block">
                      <compose view-model.bind="getDashboardView(scheme)" model.bind="schemeDashboardViewModel(scheme)"></compose>
                    </div>
                  </div>
                </div>
              </li>
            </ul>
          </div>
        </div>

        <div class="redeemSection">
          <div class="row">
            <div class="col-6 offset-3">
              <div class="title">Reputation Redemption</div>
              <div class="body">
                The bootstrapping period will end at ${lockingPeriodEndDate | date:'friendlyDateTime'}.
                After that time you will be able to redeem your earned reputation simply by clicking the 'Redeem'
                button below.
                The total amount of reputation you have earned will be transferred to your ETH address.
              </div>
              <div class="redeem-controls">
                <button id="globalRedeemBtn" class="btn btn-outline-secondary" disabled.bind="!canRedeem"
                  click.delegate="redeem">Redeem</button>
                <div if.bind="!canRedeem">The redemption period has not yet begun</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>
