<template>
  <div class="pageloader" if.bind="!loaded">
    <pageloading></pageloading>
  </div>
  <div else>
    <instructions>Select the amount of ETH you would like to lock and the length you wish to lock it for. You can lock
      as much ETH as you like, for up to 3 months. At the end of the initialization period, your reputation will be
      calculated pro rata according to the total locked ETH.</instructions>
    <div class="scheme-dashboard-body">
      <form with.bind="lockModel">

        <div if.to-view="lockingPeriodIsEnded">The locking period has ended, you can't lock</div>
        <div else>
          <div class="row">
            <div class="col-4">
              <div class="form-group bmd-form-group">
                <label for="lockAmount">ETH to lock</label>
                <input class="form-control" type='number' id="lockAmount" value.bind="amount | ethwei & updateTrigger:'blur'" />
              </div>
            </div>
            <div class="col-5">
              <div class="form-group bmd-form-group">
                <label for="lockingPeriod">Number of days</label>
                <input class="form-control" id="lockingPeriod" value.bind="period  | secondsDays & updateTrigger:'blur'" />
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-12">
              <div class="form-group">
                <button class="btn-submit btn-sm" click.delegate="lock()">Submit</button>
                <spinbutton onclick.call="refresh()" css="btn btn-secondary btn-sm" as-button="true" text="Refresh"
                  spin.to-view="refreshing" title="Refresh"></spinbutton>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-12">
              <locks-for-reputation locks.to-view="locks" release.call="release({lock})" wrapper.one-time="wrapper"></locks-for-reputation>
            </div>
          </div>

          <div if.bind="lockingPeriodIsEnded">
            <div if.to-view="!userScore" class="mb-3">You have nothing to redeem</div>
            <div else class="form-group bmd-form-group">
              <button class="btn-submit" click.delegate="redeem()">Redeem Reputation</button>
            </div>
          </div>
      </form>
    </div>
  </div>
</template>
