<template>
  <div
    class="pageloader"
    if.bind="!loaded"
  >
    <pageloading></pageloading>
  </div>
  <div else>
    <instructions if.to-view="!lockingPeriodIsEnded">
      <p>Register your wallet address that contains Magnolia (MGN) here.</p>
      <p>At the end of the vote staking period, you will be awarded Reputation proportional to the amount of MGN in the registered wallet address at the end of the Reputation period.</p>

      <p>️️️️<span
          class="warning-icon"
          style="font-size:1rem"
        >⚠️</span>&nbsp;Please make sure you are connected in ${walletService.currentWallet.name & signal:'wallet.changed'} with the same ETH address that holds or will hold your MGN tokens.</p>
    </instructions>

    <div class="scheme-dashboard-body">
      <div
        class="message"
        if.to-view="!globalPeriodHasStarted"
      >The vote staking period has not yet begun. Return between ${lockingStartTime | date:'dayofmonth'} and ${lockingEndTime | date:'dayofmonth'} to register MGN.</div>

      <div
        class="message"
        if.to-view="!alreadyRegistered && lockingPeriodHasNotStarted && globalPeriodHasStarted"
      >
        ${msUntilCanLockCountdown | timespan:"seconds"} until the 24-hour MGN registration period begins.
      </div>

      <div
        class="message"
        if.to-view="inLockingPeriod && !alreadyLocked && !alreadyRegistered"
      >
        ${msRemainingInPeriodCountdown | timespan:"seconds"} remaining to register wallet address that contains or will contain MGN at the end of the vote staking period.
      </div>

      <div
        class="message"
        if.to-view="lockingPeriodIsEnded"
      >The vote staking period has ended.</div>

      <div
        class="message"
        if.to-view="globalPeriodHasStarted && (alreadyRegistered || alreadyLocked)"
      >You have registered your wallet that contains or will contain MGN at the end of the vote staking period.</div>

      <form>
        <div class="form-group">
          <spinbutton
            if.to-view="globalPeriodHasStarted
              && lockingPeriodHasNotStarted
              && !alreadyRegistered"
            disabled.bind="registering"
            onclick.call="register()"
            css="btn-submit btn-sm"
            as-button="true"
            text="Register"
            spin.to-view="registering"
            id="registerButton"
            title.to-view="registering ? 'Registering...' : 'Register'"
          ></spinbutton>
          <metamaskfeedback if.to-view="sendingRegister"></metamaskfeedback>
          <spinbutton
            if.to-view="inLockingPeriod && !alreadyLocked && !alreadyRegistered"
            css="btn-submit btn-sm btn-register"
            disabled.bind="locking"
            onclick.call="lock()"
            as-button="true"
            text="Register"
            spin.to-view="locking"
            id="lockButton"
            title.to-view="locking ? 'Registering...' : 'Register'"
          ></spinbutton>
          <metamaskfeedback if.to-view="sending"></metamaskfeedback>
        </div>
      </form>
    </div>
  </div>
</template>
